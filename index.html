<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bowl Pick'em</title>

  <style>
    /* ---------- Background ---------- */
    html { height: 100%; }

    html::before {
      content: "";
      position: fixed;
      inset: 0;
      background-image: url("assets/kick6.webp");
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      z-index: -2;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: rgba(246, 247, 251, 0.85);
      z-index: -1;
    }

    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      margin: 0;
      color: #111;
      min-height: 100svh;
      background: transparent;
    }

    @media (max-width: 768px) {
      html::before { background-position: center top; }
    }

    /* ---------- Layout ---------- */
    .wrap { max-width: 900px; margin: 0 auto; padding: 24px; }
    .card {
      background: #fff;
      border-radius: 16px;
      padding: 18px;
      box-shadow: 0 6px 20px rgba(0,0,0,.06);
      margin-bottom: 14px;
    }

    h1 { margin: 0 0 10px; font-size: 24px; }
    h2 { margin: 0 0 10px; font-size: 18px; }
    .sub { margin: 0 0 12px; opacity: .75; }

    .row { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }

    input[type="text"] {
      width: 320px;
      max-width: 100%;
      padding: 10px 12px;
      border: 1px solid #ddd;
      border-radius: 10px;
      font-size: 14px;
    }

    button {
      padding: 10px 14px;
      border: 0;
      border-radius: 10px;
      font-weight: 700;
      cursor: pointer;
    }

    button.primary { background: #111; color: #fff; }
    button.primary:disabled { opacity: .5; cursor: not-allowed; }

    button.ghost {
      background: rgba(17,17,17,0.08);
      color: #111;
      border: 1px solid rgba(0,0,0,0.08);
    }

    .game { display: grid; gap: 10px; }
    .meta { font-size: 13px; opacity: .75; }
    .teams { font-size: 16px; font-weight: 700; }

    .pickRow { display: flex; gap: 16px; flex-wrap: wrap; }
    label { display: flex; align-items: center; gap: 8px; }

    .ok { color: #0a7a2f; font-weight: 700; }
    .err { color: #b00020; font-weight: 700; }
    .small { font-size: 12px; opacity: .75; }

    .sticky {
      position: sticky;
      top: 0;
      background: #f6f7fb;
      padding-top: 10px;
      z-index: 5;
    }

    a.leaderboard-btn {
      display: inline-block;
      padding: 8px 12px;
      border-radius: 10px;
      background: #111;
      color: #fff;
      text-decoration: none;
      font-weight: 700;
      margin-top: 6px;
    }

    /* ---------- "Your Picks" ---------- */
    #yourPicksCard { display: none; }
    .yourPicksList { margin: 0; padding-left: 18px; }
    .yourPicksList li { margin: 6px 0; }
    .chip {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 999px;
      background: rgba(0,0,0,0.06);
      font-size: 12px;
      margin-left: 8px;
      opacity: .9;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="sticky">
      <div class="card">
        <h1>College Football Bowl Pick’em 2025</h1>
        <p class="sub">Pick spreads for each game, then submit.</p>
        <p class="sub">New and improved format this year, thanks ChatGPT.</p>
        <p class="sub">Payouts tbd - will be based on total pool size.</p>

        <a class="leaderboard-btn" href="leaderboard.html">View Leaderboard & Picks</a>

        <div class="row" style="margin-top:12px;">
          <input id="name" type="text" placeholder="Your name (required)" />
          <button id="submitBtn" class="primary" disabled>Submit Picks</button>
          <button id="editBtn" class="ghost" style="display:none;">Change Picks</button>
          <span id="status" class="small"></span>
        </div>
      </div>
    </div>

    <!-- ✅ Shows after submit -->
    <div id="yourPicksCard" class="card">
      <h2>Your Picks</h2>
      <p class="sub" id="yourPicksSubtitle"></p>
      <ol class="yourPicksList" id="yourPicksList"></ol>
    </div>

    <div id="games"></div>
  </div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzDZv4jHUdu7t7crWX4-3GToFzvHKofDSfNANUrVyGCs0Igb3HPYWw8liHOEoIZGHKmnA/exec";

    // ✅ Use your real full GAMES list here (I’m leaving sample rows to keep this message readable)
    const GAMES = [
        { id: "salute-to-veterans-2025-12-16", date: "Dec 16, 2025", bowl: "IS4S Salute to Veterans Bowl",
          team1: "Troy", team2: "Jacksonville State", spread1: "-2.5", spread2: "+2.5" },

        { id: "cure-bowl-2025-12-17", date: "Dec 17, 2025", bowl: "StaffDNA Cure Bowl",
          team1: "Old Dominion", team2: "USF", spread1: "+3.5", spread2: "-3.5" },

        { id: "68-ventures-bowl-2025-12-17", date: "Dec 17, 2025", bowl: "68 Ventures Bowl",
          team1: "Louisiana", team2: "Delaware", spread1: "-3", spread2: "+3" },

        { id: "xbox-bowl-2025-12-18", date: "Dec 18, 2025", bowl: "Xbox Bowl",
          team1: "Missouri State", team2: "Arkansas State", spread1: "+1.5", spread2: "-1.5" },

        { id: "myrtle-beach-bowl-2025-12-19", date: "Dec 19, 2025", bowl: "Myrtle Beach Bowl",
          team1: "Kennesaw State", team2: "Western Michigan", spread1: "+3.5", spread2: "-3.5" },

        { id: "gasparilla-bowl-2025-12-19", date: "Dec 19, 2025", bowl: "Union Home Mortgage Gasparilla Bowl",
          team1: "Memphis", team2: "NC State", spread1: "+5.5", spread2: "-5.5" },

        { id: "cfp-first-round-1-2025-12-19", date: "Dec 19, 2025", bowl: "CFP First Round",
          team1: "Alabama", team2: "Oklahoma", spread1: "-1.5", spread2: "+1.5" },

        { id: "cfp-first-round-2-2025-12-20", date: "Dec 20, 2025", bowl: "CFP First Round",
          team1: "Miami (FL)", team2: "Texas A&M", spread1: "+3.5", spread2: "-3.5" },

        { id: "cfp-first-round-3-2025-12-20", date: "Dec 20, 2025", bowl: "CFP First Round",
          team1: "Tulane", team2: "Ole Miss", spread1: "+17.5", spread2: "-17.5" },

        { id: "cfp-first-round-4-2025-12-20", date: "Dec 20, 2025", bowl: "CFP First Round",
          team1: "James Madison", team2: "Oregon", spread1: "+21.5", spread2: "-21.5" },

        { id: "potato-bowl-2025-12-22", date: "Dec 22, 2025", bowl: "Famous Idaho Potato Bowl",
          team1: "Washington State", team2: "Utah State", spread1: "+3", spread2: "-3" },

        { id: "boca-raton-bowl-2025-12-23", date: "Dec 23, 2025", bowl: "Bush's Boca Raton Bowl of Beans",
          team1: "Toledo", team2: "Louisville", spread1: "+8.5", spread2: "-8.5" },

        { id: "new-orleans-bowl-2025-12-23", date: "Dec 23, 2025", bowl: "New Orleans Bowl",
          team1: "WKU", team2: "Southern Miss", spread1: "-4", spread2: "+4" },

        { id: "frisco-bowl-2025-12-23", date: "Dec 23, 2025", bowl: "Scooter's Coffee Frisco Bowl",
          team1: "UNLV", team2: "Ohio", spread1: "-4.5", spread2: "+4.5" },

        { id: "hawaii-bowl-2025-12-24", date: "Dec 24, 2025", bowl: "Sheraton Hawai'i Bowl",
          team1: "California", team2: "Hawai'i", spread1: "-1.5", spread2: "+1.5" },

        { id: "gameabove-sports-bowl-2025-12-26", date: "Dec 26, 2025", bowl: "GameAbove Sports Bowl",
          team1: "Central Michigan", team2: "Northwestern", spread1: "+10.5", spread2: "-10.5" },

        { id: "rate-bowl-2025-12-26", date: "Dec 26, 2025", bowl: "Rate Bowl",
          team1: "New Mexico", team2: "Minnesota", spread1: "+2.5", spread2: "-2.5" },

        { id: "first-responder-bowl-2025-12-26", date: "Dec 26, 2025", bowl: "SERVPRO First Responder Bowl",
          team1: "FIU", team2: "UTSA", spread1: "+8.5", spread2: "-8.5" },

        { id: "military-bowl-2025-12-27", date: "Dec 27, 2025", bowl: "Go Bowling Military Bowl",
          team1: "Pitt", team2: "East Carolina", spread1: "-4", spread2: "+4" },

        { id: "pinstripe-bowl-2025-12-27", date: "Dec 27, 2025", bowl: "Bad Boy Mowers Pinstripe Bowl",
          team1: "Penn State", team2: "Clemson", spread1: "+4.5", spread2: "-4.5" },

        { id: "fenway-bowl-2025-12-27", date: "Dec 27, 2025", bowl: "Wasabi Fenway Bowl",
          team1: "UConn", team2: "Army", spread1: "+7", spread2: "-7" },

        { id: "poptarts-bowl-2025-12-27", date: "Dec 27, 2025", bowl: "Pop-Tarts Bowl",
          team1: "Georgia Tech", team2: "BYU", spread1: "+4.5", spread2: "-4.5" },

        { id: "arizona-bowl-2025-12-27", date: "Dec 27, 2025", bowl: "Snoop Dogg Arizona Bowl",
          team1: "Miami (OH)", team2: "Fresno State", spread1: "+3.5", spread2: "-3.5" },

        { id: "new-mexico-bowl-2025-12-27", date: "Dec 27, 2025", bowl: "Isleta New Mexico Bowl",
          team1: "North Texas", team2: "San Diego State", spread1: "-3", spread2: "+3" },

        { id: "gator-bowl-2025-12-27", date: "Dec 27, 2025", bowl: "TaxSlayer Gator Bowl",
          team1: "Virginia", team2: "Missouri", spread1: "+7", spread2: "-7" },

        { id: "texas-bowl-2025-12-27", date: "Dec 27, 2025", bowl: "Kinder's Texas Bowl",
          team1: "LSU", team2: "Houston", spread1: "+3", spread2: "-3" },

        { id: "birmingham-bowl-2025-12-29", date: "Dec 29, 2025", bowl: "JLab Birmingham Bowl",
          team1: "Georgia Southern", team2: "App State", spread1: "-4", spread2: "+4" },

        { id: "independence-bowl-2025-12-30", date: "Dec 30, 2025", bowl: "Radiance Tech Independence Bowl",
          team1: "Coastal Carolina", team2: "Louisiana Tech", spread1: "+8.5", spread2: "-8.5" },

        { id: "music-city-bowl-2025-12-30", date: "Dec 30, 2025", bowl: "Liberty Mutual Music City Bowl",
          team1: "Tennessee", team2: "Illinois", spread1: "-4", spread2: "+4" },

        { id: "alamo-bowl-2025-12-30", date: "Dec 30, 2025", bowl: "Valero Alamo Bowl",
          team1: "USC", team2: "TCU", spread1: "-6", spread2: "+6" },

        { id: "reliaquest-bowl-2025-12-31", date: "Dec 31, 2025", bowl: "ReliaQuest Bowl",
          team1: "Iowa", team2: "Vanderbilt", spread1: "+6", spread2: "-6" },

        { id: "sun-bowl-2025-12-31", date: "Dec 31, 2025", bowl: "Tony the Tiger Sun Bowl",
          team1: "Arizona State", team2: "Duke", spread1: "+3", spread2: "-3" },

        { id: "citrus-bowl-2025-12-31", date: "Dec 31, 2025", bowl: "Cheez-It Citrus Bowl",
          team1: "Michigan", team2: "Texas", spread1: "+7.5", spread2: "-7.5" },

        { id: "las-vegas-bowl-2025-12-31", date: "Dec 31, 2025", bowl: "SRS Distribution Las Vegas Bowl",
          team1: "Nebraska", team2: "Utah", spread1: "+16.5", spread2: "-16.5" },

        { id: "armed-forces-bowl-2026-01-02", date: "Jan 2, 2026", bowl: "Lockheed Martin Armed Forces Bowl",
          team1: "Rice", team2: "Texas State", spread1: "+10", spread2: "-10" },

        { id: "liberty-bowl-2026-01-02", date: "Jan 2, 2026", bowl: "AutoZone Liberty Bowl",
          team1: "Navy", team2: "Cincinnati", spread1: "-4.5", spread2: "+4.5" },

        { id: "dukes-mayo-bowl-2026-01-02", date: "Jan 2, 2026", bowl: "Duke's Mayo Bowl",
          team1: "Wake Forest", team2: "Mississippi State", spread1: "+2.5", spread2: "-2.5" },

        { id: "holiday-bowl-2026-01-02", date: "Jan 2, 2026", bowl: "Trust & Will Holiday Bowl",
          team1: "Arizona", team2: "SMU", spread1: "-3", spread2: "+3" },
    ];

    const elGames = document.getElementById("games");
    const elName = document.getElementById("name");
    const elBtn = document.getElementById("submitBtn");
    const elEdit = document.getElementById("editBtn");
    const elStatus = document.getElementById("status");

    const elYourPicksCard = document.getElementById("yourPicksCard");
    const elYourPicksSubtitle = document.getElementById("yourPicksSubtitle");
    const elYourPicksList = document.getElementById("yourPicksList");

    const picks = {}; // gameId -> pickedTeam
    let locked = false;

    function escapeHtml(s) {
      return String(s ?? "").replace(/[&<>"']/g, c => ({
        "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"
      }[c]));
    }

    function render() {
      elGames.innerHTML = "";

      for (const g of GAMES) {
        const card = document.createElement("div");
        card.className = "card game";

        const t1Label = `${g.team1} ${g.spread1 || ""}`.trim();
        const t2Label = `${g.team2} ${g.spread2 || ""}`.trim();

        card.innerHTML = `
          <div class="meta">${escapeHtml(g.date)} - ${escapeHtml(g.bowl)}</div>
          <div class="teams">${escapeHtml(g.team1)} vs ${escapeHtml(g.team2)}</div>
          <div class="pickRow">
            <label>
              <input type="radio" name="pick-${escapeHtml(g.id)}" value="${escapeHtml(g.team1)}">
              ${escapeHtml(t1Label)}
            </label>
            <label>
              <input type="radio" name="pick-${escapeHtml(g.id)}" value="${escapeHtml(g.team2)}">
              ${escapeHtml(t2Label)}
            </label>
          </div>
        `;

        elGames.appendChild(card);

        // Restore selection (if any)
        const selected = picks[g.id];
        if (selected) {
          const sel = card.querySelector(`input[value="${CSS.escape(selected)}"]`);
          if (sel) sel.checked = true;
        }

        card.querySelectorAll(`input[name="pick-${g.id}"]`).forEach(inp => {
          inp.disabled = locked;
          inp.addEventListener("change", e => {
            picks[g.id] = e.target.value;
            validate();
          });
        });
      }

      validate();
    }

    function validate() {
      const nameOk = elName.value.trim().length > 0;
      const allPicked = GAMES.every(g => picks[g.id]);
      const urlOk = SCRIPT_URL && SCRIPT_URL.startsWith("https://script.google.com/") && SCRIPT_URL.endsWith("/exec");

      elBtn.disabled = locked || !(nameOk && allPicked && urlOk);

      elStatus.textContent =
        !urlOk ? "Fix SCRIPT_URL (must end with /exec)." :
        !nameOk ? "Enter your name." :
        !allPicked ? "Pick every game." : "";

      elStatus.className = "small";
    }

    function setLocked(isLocked) {
      locked = isLocked;
      elName.disabled = isLocked;
      elEdit.style.display = isLocked ? "" : "none";
      render();
    }

    function showYourPicks() {
      const name = elName.value.trim();
      elYourPicksSubtitle.textContent = `${name} — here’s what you submitted.`;

      elYourPicksList.innerHTML = GAMES.map(g => {
        const matchup = `${g.team1} vs ${g.team2}`;
        const pick = picks[g.id] || "—";
        return `<li><strong>${escapeHtml(matchup)}</strong><span class="chip">${escapeHtml(pick)}</span></li>`;
      }).join("");

      elYourPicksCard.style.display = "";
      elYourPicksCard.scrollIntoView({ behavior: "smooth", block: "start" });
    }

    elName.addEventListener("input", validate);

    elEdit.addEventListener("click", () => {
      elYourPicksCard.style.display = "none";
      elStatus.textContent = "Edit your picks, then re-submit.";
      elStatus.className = "small";
      setLocked(false);
    });

    elBtn.addEventListener("click", async () => {
      elBtn.disabled = true;
      elStatus.textContent = "Submitting…";
      elStatus.className = "small";

      const payload = { name: elName.value.trim(), picks };

      try {
        const res = await fetch(SCRIPT_URL, {
          method: "POST",
          headers: { "Content-Type": "text/plain;charset=utf-8" },
          body: JSON.stringify(payload)
        });

        const data = await res.json().catch(() => ({}));
        if (!data.ok) throw new Error(data.error || "Submission failed");

        elStatus.textContent = "Submitted! ✅";
        elStatus.className = "ok";

        // ✅ lock UI + show picks
        setLocked(true);
        showYourPicks();
      } catch (err) {
        elStatus.textContent = "Error: " + err.message;
        elStatus.className = "err";
        validate();
      }
    });

    render();
  </script>
</body>
</html>
